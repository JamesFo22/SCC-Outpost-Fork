<% content_for :header do %>
    <h1 class="page-header__title">Services</h1>
    <%= render "shared/services-nav" %>
<% end %>

<% if @requests.present? %>
  <ul class="pending-list">
    <% @requests.each do |s| %>
      <li class="pending-panel">
        <div>
          <h2><%= link_to s.display_name.truncate(25), admin_service_path(s) %></h2>
          <p>
            <%= time_ago_in_words(s.updated_at).humanize %> ago
            <% if s.snapshots.last.user %>
              by <%= render "shared/poppables/user", u: s.snapshots.last.user %>
            <% end %>
          </p>
        </div>

        <% if s.discarded?  %>
          <div class="pending-status pending-status--deleted">
            <strong>Archived service</strong>
          </div>
        <% elsif s.last_approved_snapshot %>
          <div class="pending-status">
            <strong>Changed service</strong>
            <p><%= s.unapproved_fields.join(", ").humanize %></p>
          </div>
        <% else %>
          <div class="pending-status pending-status--new">
            <strong>New service</strong>
          </div>
        <% end %>
        <%= link_to "Approve", admin_request_path(s), method: "patch", class: "button" %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p class="no-results no-results--big">Nothing pending right now</p>
<% end %>