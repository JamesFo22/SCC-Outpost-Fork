<% content_for :header do %>
    <%= link_to "Back to locations", admin_locations_path, class: "go-back" %>
    <h1 class="page-header__title two-thirds"><%= @location.display_name %></h1>
<% end %>

<div class="two-panels">

    <div class="panel">
      <%= form_for [:admin, @location] do |f| %>
          <%= render "shared/errors", model: @location %>

          <div class="collapsible" id="location-address-editor">
            <button class="collapsible__header">
              <h2>Address</h2>
            </button>
            <div class="collapsible__content">
              <%= render "fields", f: f %>
            </div>
          </div>

          <fieldset class="collapsible" id="location-accessibility-editor">
              <button class="collapsible__header">
                <legend>
                  <h2>Accessibility</h2>
                </legend>
              </button>
            <div class="collapsible__content">

              <div class="field-section field-section--two-cols field-section--no-bottom-margin">
                <%= f.collection_check_boxes( :accessibility_ids, Accessibility.all, :id, :name) do |c| %>
                    <div class="field checkbox">
                        <%= c.check_box class: "checkbox__input" %>
                        <%= c.label class: "checkbox__label" %>
                    </div>
                <% end %>
              </div>

            </div>
          </fieldset>

          <%= f.submit "Update", class: "button" %>
      <% end %>
    </div>

    <div class="panel">

      <div class="collapsible" id="map-preview">
        <button class="collapsible__header">
          <h2>Preview</h2>
        </button>
        <div class="collapsible__content">
          <% if @location.latitude && @location.longitude %>
            <%= link_to "Show larger map", "https://www.google.com/maps/search/#{@location.latitude},#{@location.longitude}", class: "collapsible__action" %>
            <%= map(@location.latitude, @location.longitude)%>
          <% else %>
            <p>Couldn't calculate coordinates for this location.</p>
          <% end %>
        </div>
      </div>

      <div class="collapsible" id="location-services">
        <button class="collapsible__header">
          <h2>
            Services
            <span class="collapsible__header-count">(<%= @location.services.count %>)</span>
          </h2>
        </button>
        <div class="collapsible__content">
        <% if @location.services.present? %>
          <ul class="big-list">
            <% @location.services.each do |s| %>
              <li class="big-list__item">
                <%= render "shared/poppables/service", s: s %>
              </li>
            <% end %>
          </ul>
        <% else %>
          <p>No services at this location</p>
        <% end %>

        </div>
      </div>

    </div>
</div>
